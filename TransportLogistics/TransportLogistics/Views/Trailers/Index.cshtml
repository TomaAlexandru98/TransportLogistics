@using TransportLogistics.Models.Trailers
@model List<TransportLogistics.Model.Trailer>


@{
    ViewData["Title"] = "Index";
}

<link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<link href="https://cdn.datatables.net/buttons/1.6.1/css/buttons.dataTables.min.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.datatables.net/select/1.3.1/css/select.dataTables.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<link href="https://nightly.datatables.net/css/jquery.dataTables.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="https://nightly.datatables.net/js/jquery.dataTables.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"><</script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
<link href="https://cdn.datatables.net/select/1.2.1/css/select.dataTables.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="https://cdn.datatables.net/select/1.2.1/js/dataTables.select.min.js"></script>
<link href="https://cdn.datatables.net/buttons/1.2.4/css/buttons.dataTables.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.2.4/js/dataTables.buttons.min.js"></script>
<link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css" rel="stylesheet" type="text/css" />
<div class="d-flex flex-column flex-md-row">
    <div class="d-flex flex-column flex-grow-1">

    </div>
    <div class="d-flex flex-column ">
        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <button class="btn-car" data-toggle="modal" data-target="#newTrailerModal">
                    <i class="fa fa-trailer"></i>Add Trailer
                </button>

            </div>
        </div>
    </div>
</div>
<table id="Trailer" class="table table-striped table-bordered" width="100%">
    <thead>
        <tr>
            <th>Model</th>
            <th>MaximWeightKg</th>
            <th>Capacity</th>
            <th>NumberAxles</th>
            <th>Height</th>
            <th>Width</th>
            <th>Length</th>
            <th>Edit / Delete</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var trailer in Model)
        {
            <tr>

                <td>
                    @Html.DisplayFor(modelItem => trailer.Model)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => trailer.MaximWeightKg)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => trailer.Capacity)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => trailer.NumberAxles)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => trailer.Height)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => trailer.Width)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => trailer.Length)
                </td>
                <td style="max-width:20%" >
                    <div class="d-flex justify-content-around">
                        @using (Html.BeginForm("EditTrailer", "Trailers", FormMethod.Post))
                        {
                            @Html.AntiForgeryToken()
                            <a name="ID" id="@trailer.Id" class="btn btn-outline-dark mr-1 ml-1" title="Edit" data-toggle="modal" data-target="#editTrailerModal" onclick="LoadEditTrailerView('@trailer.Id');"><i class="material-icons fa fa-edit"></i></a>
                        }
                        <button class="btn btn-outline-danger mr-1 ml-1" title="Delete" data-toggle="modal"
                                onclick="LoadRemoveTrailerView('@trailer.Id');" data-target="#removeModal">
                            <i class="material-icons fa fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>


@section scripts{
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/partialViewLoader.js" type="text/javascript"></script>
    <script>
                $(document).ready(function () {
                    $('#Trailer').DataTable({ responsive: true });
                });
                $(function () {
                    $('#modal').modal('toggle');
                });

                function LoadEditTrailerView(Id) {
                    loadServerPartialView("#editTrailerBody",'@Url.Action("EditTrailer", "Trailers")'+"/" + Id);
                }

                function CloseModal(modalName) {
                    $(modalName).modal("hide");
                    setTimeout(function () {
                        window.location.reload();
                    }, 200); }
        function ConfirmDelete() {
            var x = confirm("Are you sure you want to delete?");
            if (x)
                return true;
            else
                return false;
        }

        function LoadRemoveTrailerView(Id) {
             loadServerPartialView("#removeBody",'@Url.Action("Delete", "Trailers")'+"/" + Id);
        }

    </script>
}
<form id="editTrailerForm" method="post" asp-controller="Trailers" asp-action="EditTrailer"
      data-ajax="true"
      data-ajax-method="POST"
      data-ajax-mode="replace"
      data-ajax-update="#editTrailerBody">

    @Html.AntiForgeryToken()
    <div class="modal" id="editTrailerModal" tabindex="-1" role="dialog" aria-labelledby="editTrailerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title font-weight-bold" id="editTrailerModalLabel">New Trailer</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div id="editTrailerBody" class="modal-body">
                    @await Html.PartialAsync("_NewTrailerPartial", new NewTrailerViewModel { })
                </div>


                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary shadow-button" data-dismiss="modal">Close</button>
                    <button id="btnSave" class="btn btn-success" type="submit" data-dismiss="modal" onclick="CloseModal('#editTrailerModal')"> Confirm </button>
                </div>
            </div>
        </div>
    </div>
</form>

<form id="newTrailerForm" method="post" asp-controller="Trailers" asp-action="NewTrailer"
      data-ajax="true"
      data-ajax-method="POST"
      data-ajax-mode="replace"
      data-ajax-update="#newTrailerBody">

    @Html.AntiForgeryToken()
    <div class="modal" id="newTrailerModal" tabindex="-1" role="dialog" aria-labelledby="newTrailerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title font-weight-bold" id="newTrailerModalLabel">New Trailer</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div id="newTrailerBody" class="modal-body">
                    @await Html.PartialAsync("_NewTrailerPartial", new NewTrailerViewModel { })
                </div>


                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary shadow-button" data-dismiss="modal">Close</button>
                    <button id="btnSave" class="btn btn-success" type="submit"data-dismiss="modal" onclick="CloseModal('#newTrailerModal')"> Confirm </button>
                </div>
            </div>
        </div>
    </div>
</form>

<form method="post" asp-controller="Trailers" asp-action="Remove"
      data-ajax="true"
      data-ajax-method="POST"
      data-ajax-mode="replace"
      data-ajax-update="#removeBody">

    <div class="modal fade" id="removeModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog d-flex justify-content-center" role="document">
            <div class="modal-content" style="max-width: 60%">
                <div class="modal-body" id="removeBody">
                    <partial name="_RemoveTrailerPartial" model="new RemoveTrailerViewModel()" />
                </div>
            </div>
        </div>
    </div>
</form>
